import{k as D,r as O,g as U,l as A,h as G,m as T,j as e,R as m,L as _,i as j,B as c}from"./index-BWO5Dofk.js";import{L as J}from"./index-CWZvREIp.js";import{u as V,B as S}from"./index-DSI1hvh5.js";import{R as q}from"./index-BNmHKL0P.js";import{I as l}from"./index-BVC0U8wP.js";import{u as K}from"./formik.esm-DaXxEDLd.js";import{r as Q}from"./validation-schemas-a_DpdEsn.js";const ae=()=>{var x;const b=D(),[p,v]=O.useState(((x=b.state)==null?void 0:x.step)||0),{t:s}=V(),y=U(),[P,R]=A(),[B,C]=G(),[L]=T(),{errors:a,touched:n,handleBlur:o,values:k,handleChange:t,handleSubmit:E,validateField:i}=K({initialValues:{email:"",password:"",confirmPassword:"",name:"",surname:""},onSubmit:()=>{},validationSchema:Q}),{email:d,password:u,confirmPassword:I,name:f,surname:g}=k,F=()=>{v(r=>r+1)},H=async()=>{if(a.email||a.password||a.confirmPassword){i("email"),i("password"),i("confirmPassword");return}const r=await P({email:d,password:u});if(r.error){if("data"in r.error){const h=r.error.data;let N="";for(const w in h.errors)w!=="DuplicateUserName"&&(N+=h.errors[w].map(z=>z).join(`
`));c.error(N||s("Register failed"),{className:"!bg-error"});return}c.error(s("Register failed"),{className:"!bg-error"});return}await B({email:d,password:u}),F()},M=async()=>{if(a.name||a.surname){i("name"),i("surname");return}try{if((await L({name:f,surname:g})).error){c.error(s("Adding details failed"),{className:"!bg-error"});return}y(m.HOME)}catch(r){c.error(JSON.stringify(r),{className:"!bg-error"})}};return e.jsx(J,{children:e.jsxs("form",{onSubmit:E,className:"w-full flex flex-col items-center",children:[e.jsx("h1",{className:"text-[2.5rem]",children:s("Sign Up")}),p===0&&e.jsxs(e.Fragment,{children:[e.jsx(q,{to:m.HOME,className:"mt-2 mb-4",children:s("return to Home page")}),e.jsxs("span",{className:"text-teal600 font-semibold mb-4",children:[s("Please fill in all of the fields"),"."]}),e.jsx(l,{label:s("Email"),type:"email",name:"email",onChange:t,onBlur:o,value:d,error:n.email?a.email:void 0}),e.jsx(l,{className:"my-4",label:s("Password"),type:"password",name:"password",onChange:t,onBlur:o,value:u,error:n.password?a.password:void 0}),e.jsx(l,{label:s("Confirm password"),type:"password",name:"confirmPassword",onChange:t,onBlur:o,value:I,error:n.confirmPassword?a.confirmPassword:void 0}),(R.isLoading||C.isLoading)&&e.jsx(_,{className:"!size-8 mt-4"}),e.jsx(S,{size:"sm",className:"w-full mt-6 mb-2",onClick:H,children:s("Next")}),e.jsxs("span",{children:[s("Have an account"),"?"," ",e.jsx(j,{to:m.SIGN_IN,className:"underline decoration-1 text-orange400",children:s("Sign in")})]})]}),p===1&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-teal600 font-semibold mb-4",children:[s("Please fill in all of the fields"),"."]}),e.jsx(l,{label:s("Name"),type:"text",name:"name",onChange:t,onBlur:o,value:f,error:n.name?a.name:void 0}),e.jsx(l,{className:"mt-4",label:s("Surname"),type:"text",name:"surname",onChange:t,onBlur:o,value:g,error:n.surname?a.surname:void 0}),e.jsx(S,{size:"sm",className:"w-full mt-6 mb-2",onClick:M,children:s("Sign up")}),e.jsxs("span",{children:[s("Have an account"),"?"," ",e.jsx(j,{to:m.SIGN_IN,className:"underline decoration-1 text-orange400",children:s("Sign in")})]})]})]})})};export{ae as default};
