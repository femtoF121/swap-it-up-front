import{r as h,h as R,j as e,c as j,R as v,V as S,W as U,X as z,Y as E,Z as A,L as f,G as Y,B as i,_ as B}from"./index-saUlMH2a.js";import{C as u}from"./index-CJw5recu.js";import{R as G}from"./index-DTbUessp.js";import{L as T}from"./index-BljTXoUS.js";import{U as b}from"./index-DwxKZQlD.js";import{u as N,B as p}from"./index-DxUx3JSk.js";import{i as H}from"./placeholder-image-CBe2Di1M.js";import{w as O,U as P}from"./with-auth-DdBmo0bw.js";const y=({item:a,myItem:n=!1})=>{const[c,o]=h.useState(!1),{t}=N(),l=R();return e.jsxs(u,{className:j("!p-3 flex gap-2 font-[400] hover:brightness-95 cursor-pointer"),onClick:()=>l(v.ITEM.replace(":id",a.id)),children:[e.jsxs("div",{className:"relative aspect-[16/12] w-full max-w-[100px] mobile:max-w-[75px] rounded-lg overflow-hidden shrink-0hover:brightness-95 cursor-pointer",children:[!c&&e.jsx("div",{className:"skeleton-loader !rounded-none"}),e.jsx("img",{src:a.pictureIds[0]?"https://apim-swapitup.azure-api.net/api/items/pictures/"+a.pictureIds[0]:H,alt:"wanted item photo",className:j("w-full h-full object-cover",{hidden:!c}),onLoad:()=>o(!0)})]}),e.jsxs("div",{className:"text-[12px]",children:[e.jsx("h4",{className:"line-clamp-1 break-all text-[16px] mb-2",children:t(a.name)}),n?e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[t("Category"),": "]}),a.category]}):e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[t("Wants to exchange on"),":"]}),e.jsx("br",{}),e.jsx("span",{className:"line-clamp-1",children:a.wantedCategory})]})]})]})},D=({offered:a,requested:n,myDeal:c,incoming:o=!1,status:t,id:l,refetch:x})=>{const{t:s}=N(),{data:r,isLoading:m}=S(c?n.userId:a.userId),[d]=U(),[C]=z(),[I]=E(),[k]=A(),w=async()=>{if((await d(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal deleted"),{className:"!bg-green100"}),x()},L=async()=>{if((await C(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal accepted"),{className:"!bg-green100"}),x()},F=async()=>{if((await I(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal canceled"),{className:"!bg-green100"}),x()},M=async()=>{if((await k(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal finished"),{className:"!bg-green100"}),x()};return e.jsx(u,{className:"!font-semibold w-full",children:m?e.jsx(f,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:j("flex gap-4 w-full",r?"justify-between":"justify-end"),children:[r&&e.jsxs("h2",{className:"text-[24px] below-768:text-[24px] mb-[24px] below-768:mb-[4px] leading-none",children:[s("Deal")," ",s("with")," ",e.jsx(b,{user:r})]}),e.jsxs("div",{children:[s("Status"),": ",t===0?e.jsx("span",{className:"text-orange400",children:s("Requested")}):t===1?e.jsx("span",{className:"text-green600",children:s("Started")}):t===2?e.jsx("span",{className:"text-soft-red",children:s("Canceled")}):t===4?e.jsx("span",{className:"text-teal400",children:s("Finished")}):"..."]})]}),e.jsxs("div",{className:"w-full shrink-[1.1]",children:[e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Item of user")," ",e.jsx(b,{user:r,withRating:!1}),":"]}),e.jsx(y,{item:c?n:a}),e.jsxs("div",{className:"relative mb-[24px] mt-[32px] below-768:mb-[16px]  below-768:mt-[20px]",children:[e.jsx(Y,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white100 px-2 box-content"}),e.jsx("hr",{className:"h-px border-none w-full bg-green400"})]}),e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Your item"),":"]}),e.jsx(y,{myItem:!0,item:c?a:n})]}),e.jsxs("div",{className:"flex items-center justify-end gap-[16px] mt-[16px]",children:[o&&t===0&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:w,children:s("Decline")}),e.jsx(p,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:L,children:s("Accept")})]}),t===1&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:F,children:s("Cancel")}),e.jsx(p,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:M,children:s("Finish")})]}),(t===0&&!o||t===2||t===4)&&e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:w,children:s("Delete")})]})]})})},Q=()=>{const{t:a}=N(),n=h.useContext(P),{data:c,isLoading:o,refetch:t}=B(),[l,x]=h.useState([]);return h.useEffect(()=>{c&&x(c.list.filter(({requestedItem:s,offeredItem:r})=>s.userId===n.id||r.userId===n.id))},[c,x]),e.jsxs(T,{children:[e.jsx(G,{to:v.HOME,children:a("return to Home page")}),e.jsxs(u,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:a("Outcoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId!==n.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId!==n.id).map(({status:s,offeredItem:r,requestedItem:m,id:d})=>e.jsx(D,{id:d,myDeal:r.userId===n.id,offered:r,requested:m,status:s,refetch:t},d))}):e.jsx("span",{className:"text-xl font-semibold",children:a("You don't have any outcoming deals yet")})]}),e.jsxs(u,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:a("Incoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId===n.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId===n.id).map(({status:s,offeredItem:r,requestedItem:m,id:d})=>e.jsx(D,{id:d,incoming:!0,myDeal:r.userId===n.id,offered:r,requested:m,status:s,refetch:t},d))}):e.jsx("span",{className:"text-xl font-semibold",children:a("You don't have any incoming deals yet")})]})]})},$=O(Q);export{$ as default};
