import{r as u,g as M,j as e,c as g,R as N,U as R,V as S,W as U,X as z,Y as A,L as f,E as Y,i as B,B as i,Z as O}from"./index-D5iiHLqA.js";import{C as j}from"./index-Cl53XqXm.js";import{R as P}from"./index-DupVUGWc.js";import{L as T}from"./index-YBH3LB-v.js";import{u as b,B as h}from"./index-BFrpPwaA.js";import{i as G}from"./placeholder-image-CBe2Di1M.js";import{w as H,U as Q}from"./with-auth-Bzouhty6.js";const D=({item:n,myItem:t=!1})=>{const[c,o]=u.useState(!1),{t:a}=b(),l=M();return e.jsxs(j,{className:g("!p-3 flex gap-2 font-[400] hover:brightness-95 cursor-pointer"),onClick:()=>l(N.ITEM.replace(":id",n.id)),children:[e.jsxs("div",{className:"relative aspect-[16/12] w-full max-w-[100px] mobile:max-w-[75px] rounded-lg overflow-hidden shrink-0hover:brightness-95 cursor-pointer",children:[!c&&e.jsx("div",{className:"skeleton-loader !rounded-none"}),e.jsx("img",{src:n.pictureIds[0]?"https://swapitup.azurewebsites.net/api/items/pictures/"+n.pictureIds[0]:G,alt:"wanted item photo",className:g("w-full h-full object-cover",{hidden:!c}),onLoad:()=>o(!0)})]}),e.jsxs("div",{className:"text-[12px]",children:[e.jsx("h4",{className:"line-clamp-1 break-all text-[16px] mb-2",children:a(n.name)}),t?e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[a("Category"),": "]}),n.category]}):e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[a("Wants to exchange on"),":"]}),e.jsx("br",{}),e.jsx("span",{className:"line-clamp-1",children:n.wantedCategory})]})]})]})},v=({offered:n,requested:t,myDeal:c,incoming:o=!1,status:a,id:l,refetch:x})=>{const{t:s}=b(),{data:r,isLoading:m}=R(c?t.userId:n.userId),[d]=S(),[C]=U(),[I]=z(),[k]=A();console.log(a);const w=({className:p})=>{if(r)return e.jsxs(B,{to:N.PROFILE.replace(":id",r.id),className:g("text-green600",p),children:[r.name," ",r.surname]})},y=async()=>{if((await d(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal deleted"),{className:"!bg-green100"}),x()},L=async()=>{if((await C(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal accepted"),{className:"!bg-green100"}),x()},F=async()=>{if((await I(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal canceled"),{className:"!bg-green100"}),x()},E=async()=>{if((await k(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal finished"),{className:"!bg-green100"}),x()};return e.jsx(j,{className:"!font-semibold w-full",children:m?e.jsx(f,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:g("flex gap-4 w-full",r?"justify-between":"justify-end"),children:[r&&e.jsxs("h2",{className:"text-[24px] below-768:text-[24px] mb-[24px] below-768:mb-[4px] leading-none",children:[s("Deal")," ",s("with")," ",e.jsx(w,{})]}),e.jsxs("div",{children:[s("Status"),": ",a===0?e.jsx("span",{className:"text-orange400",children:s("Requested")}):a===1?e.jsx("span",{className:"text-green600",children:s("Started")}):a===2?e.jsx("span",{className:"text-soft-red",children:s("Canceled")}):a===4?e.jsx("span",{className:"text-teal400",children:s("Finished")}):"..."]})]}),e.jsxs("div",{className:"w-full shrink-[1.1]",children:[e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Item of user")," ",e.jsx(w,{}),":"]}),e.jsx(D,{item:c?t:n}),e.jsxs("div",{className:"relative mb-[24px] mt-[32px] below-768:mb-[16px]  below-768:mt-[20px]",children:[e.jsx(Y,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white100 px-2 box-content"}),e.jsx("hr",{className:"h-px border-none w-full bg-green400"})]}),e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Your item"),":"]}),e.jsx(D,{myItem:!0,item:c?n:t})]}),e.jsxs("div",{className:"flex items-center justify-end gap-[16px] mt-[16px]",children:[o&&a===0&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:y,children:s("Decline")}),e.jsx(h,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:L,children:s("Accept")})]}),a===1&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:F,children:s("Cancel")}),e.jsx(h,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:E,children:s("Finish")})]}),(a===0&&!o||a===2||a===4)&&e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:y,children:s("Delete")})]})]})})},W=()=>{const{t:n}=b(),t=u.useContext(Q),{data:c,isLoading:o,refetch:a}=O(),[l,x]=u.useState([]);return u.useEffect(()=>{c&&x(c.list.filter(({requestedItem:s,offeredItem:r})=>s.userId===t.id||r.userId===t.id))},[c,x]),e.jsxs(T,{children:[e.jsx(P,{to:N.HOME,children:n("return to Home page")}),e.jsxs(j,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:n("Outcoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId!==t.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId!==t.id).map(({status:s,offeredItem:r,requestedItem:m,id:d})=>e.jsx(v,{id:d,myDeal:r.userId===t.id,offered:r,requested:m,status:s,refetch:a},d))}):e.jsx("span",{className:"text-xl font-semibold",children:n("You don't have any outcoming deals yet")})]}),e.jsxs(j,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:n("Incoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId===t.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId===t.id).map(({status:s,offeredItem:r,requestedItem:m,id:d})=>e.jsx(v,{id:d,incoming:!0,myDeal:r.userId===t.id,offered:r,requested:m,status:s,refetch:a},d))}):e.jsx("span",{className:"text-xl font-semibold",children:n("You don't have any incoming deals yet")})]})]})},$=H(W);export{$ as default};
