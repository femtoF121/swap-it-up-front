import{r as u,h as F,j as e,c as j,R as D,C as E,E as U,B as x,V as A,W as O,X as Y,Y as q,Z as B,L as w,G,_ as T}from"./index-Cy8KZEeU.js";import{C as h}from"./index-DvXISprr.js";import{R as H}from"./index-XFbWl7AG.js";import{L as P}from"./index-BIIKndDZ.js";import{U as b}from"./index-QT7Hzmcn.js";import{u as f,B as p}from"./index-CtphUI7L.js";import{i as Q}from"./placeholder-image-CBe2Di1M.js";import{w as W,U as V}from"./with-auth-PJTcXW4q.js";const y=({item:t,myItem:l=!1})=>{const[c,d]=u.useState(!1),{t:a}=f(),r=F();return e.jsxs(h,{className:j("!p-3 flex gap-2 font-[400] hover:brightness-95 cursor-pointer"),onClick:()=>r(D.ITEM.replace(":id",t.id)),children:[e.jsxs("div",{className:"relative aspect-[16/12] w-full max-w-[100px] mobile:max-w-[75px] rounded-lg overflow-hidden shrink-0hover:brightness-95 cursor-pointer",children:[!c&&e.jsx("div",{className:"skeleton-loader !rounded-none"}),e.jsx("img",{src:t.pictureIds[0]?"https://apim-swapitup.azure-api.net/api/items/pictures/"+t.pictureIds[0]:Q,alt:"wanted item photo",className:j("w-full h-full object-cover",{hidden:!c}),onLoad:()=>d(!0)})]}),e.jsxs("div",{className:"text-[12px]",children:[e.jsx("h4",{className:"line-clamp-1 break-all text-[16px] mb-2",children:a(t.name)}),l?e.jsxs("p",{className:"capitalize",children:[e.jsxs("span",{className:"text-green600",children:[a("Category"),": "]}),t.category]}):e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[a("Wants to exchange on"),":"]}),e.jsx("br",{}),e.jsx("span",{className:"line-clamp-1 capitalize",children:t.wantedCategory})]})]})]})},X=({onClose:t,isOpen:l,className:c,...d})=>{const{t:a}=f(),r=E(t),[m]=U(),n=async()=>{if((await m({})).error){x.error(a("Something went wrong, try again later."),{className:"!bg-error"});return}x.success(a("Request sent successfully"),{className:"!bg-green100"}),t()};if(u.useEffect(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l]),l)return e.jsx("div",{className:"fixed z-20 w-full min-h-screen top-0 bg-white400/40 flex justify-center items-center",children:e.jsx("div",{className:" w-full max-w-[850px] mx-10 my-4",ref:r,...d,children:e.jsxs(h,{className:"!font-semibold w-full",children:[e.jsx("div",{className:"flex gap-[24px] below-768:gap-[16px] below-768:flex-col-reverse",children:e.jsx("div",{className:"w-full flex flex-col",children:e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[a("Your items"),":"]})})}),e.jsxs("div",{className:"flex items-center justify-end gap-[16px] mt-[16px]",children:[e.jsx("button",{className:"hover:underline decoration-[1.5px] text-[16px]",onClick:t,children:a("Cancel")}),e.jsx(p,{type:"submit",size:"sm",onClick:n,className:"!text-[16px] !px-[24px] !h-[40px]",children:a("Send request")})]})]})})})},v=({offered:t,requested:l,myDeal:c,incoming:d=!1,status:a,id:r,refetch:m})=>{const[n,i]=u.useState(!1),{t:s}=f(),{data:o,isLoading:C}=A(c?l.userId:t.userId),[I]=O(),[k]=Y(),[M]=q(),[S]=B(),N=async()=>{if((await I(r)).error){x.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}x.success(s("Deal deleted"),{className:"!bg-green100"}),m()},z=async()=>{if((await k(r)).error){x.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}x.success(s("Deal accepted"),{className:"!bg-green100"}),m()},L=async()=>{if((await M(r)).error){x.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}x.success(s("Deal canceled"),{className:"!bg-green100"}),m()},R=async()=>{if((await S(r)).error){x.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}x.success(s("Deal finished"),{className:"!bg-green100"}),m(),i(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"!font-semibold w-full",children:C?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:j("flex gap-4 w-full",o?"justify-between":"justify-end"),children:[o&&e.jsxs("h2",{className:"text-[24px] below-768:text-[24px] mb-[24px] below-768:mb-[4px] leading-none",children:[s("Deal")," ",s("with")," ",e.jsx(b,{user:o})]}),e.jsxs("div",{children:[s("Status"),": ",a===0?e.jsx("span",{className:"text-orange400",children:s("Requested")}):a===1?e.jsx("span",{className:"text-green600",children:s("Started")}):a===2?e.jsx("span",{className:"text-soft-red",children:s("Canceled")}):a===4?e.jsx("span",{className:"text-teal400",children:s("Finished")}):"..."]})]}),e.jsxs("div",{className:"w-full shrink-[1.1]",children:[e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Item of user")," ",e.jsx(b,{user:o,withRating:!1}),":"]}),e.jsx(y,{item:c?l:t}),e.jsxs("div",{className:"relative mb-[24px] mt-[32px] below-768:mb-[16px]  below-768:mt-[20px]",children:[e.jsx(G,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white100 px-2 box-content"}),e.jsx("hr",{className:"h-px border-none w-full bg-green400"})]}),e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Your item"),":"]}),e.jsx(y,{myItem:!0,item:c?t:l})]}),e.jsxs("div",{className:"flex items-center justify-end gap-[16px] mt-[16px]",children:[d&&a===0&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:N,children:s("Decline")}),e.jsx(p,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:z,children:s("Accept")})]}),a===1&&e.jsxs(e.Fragment,{children:[e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:L,children:s("Cancel")}),e.jsx(p,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:R,children:s("Finish")})]}),(a===0&&!d||a===2||a===4)&&e.jsx(p,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:N,children:s("Delete")})]})]})}),e.jsx(X,{isOpen:n,onClose:()=>i(!1)})]})},Z=()=>{const{t}=f(),l=u.useContext(V),{data:c,isLoading:d,refetch:a}=T(),[r,m]=u.useState([]);return u.useEffect(()=>{c&&m(c.list.filter(({requestedItem:n,offeredItem:i})=>n.userId===l.id||i.userId===l.id))},[c,m]),e.jsxs(P,{children:[e.jsx(H,{to:D.HOME,children:t("return to Home page")}),e.jsxs(h,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:t("Outcoming deals")}),d?e.jsx(w,{className:"mx-auto mt-4"}):r.filter(({requestedItem:n})=>n.userId!==l.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:r.filter(({requestedItem:n})=>n.userId!==l.id).map(({status:n,offeredItem:i,requestedItem:s,id:o})=>e.jsx(v,{id:o,myDeal:i.userId===l.id,offered:i,requested:s,status:n,refetch:a},o))}):e.jsx("span",{className:"text-xl font-semibold",children:t("You don't have any outcoming deals yet")})]}),e.jsxs(h,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:t("Incoming deals")}),d?e.jsx(w,{className:"mx-auto mt-4"}):r.filter(({requestedItem:n})=>n.userId===l.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:r.filter(({requestedItem:n})=>n.userId===l.id).map(({status:n,offeredItem:i,requestedItem:s,id:o})=>e.jsx(v,{id:o,incoming:!0,myDeal:i.userId===l.id,offered:i,requested:s,status:n,refetch:a},o))}):e.jsx("span",{className:"text-xl font-semibold",children:t("You don't have any incoming deals yet")})]})]})},le=W(Z);export{le as default};
