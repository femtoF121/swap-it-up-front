import{r as u,g as S,j as e,c as g,R as N,U as F,V as M,W as U,X as _,Y as A,L as f,E as z,i as O,B as i,Z as B}from"./index-DGM8O2GK.js";import{C as j}from"./index-DfStVS8K.js";import{R as P}from"./index-BJ4rP69i.js";import{L as T}from"./index-C27KeCKp.js";import{u as b,B as h}from"./index-BQR--jp_.js";import{i as V}from"./placeholder-image-BN37adGx.js";import{w as Y,U as G}from"./with-auth-wi_QHfPK.js";var H={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const y=({item:n,myItem:r=!1})=>{const[c,o]=u.useState(!1),{t:a}=b(),l=S();return e.jsxs(j,{className:g("!p-3 flex gap-2 font-[400] hover:brightness-95 cursor-pointer"),onClick:()=>l(N.ITEM.replace(":id",n.id)),children:[e.jsxs("div",{className:"relative aspect-[16/12] w-full max-w-[100px] mobile:max-w-[75px] rounded-lg overflow-hidden shrink-0hover:brightness-95 cursor-pointer",children:[!c&&e.jsx("div",{className:"skeleton-loader !rounded-none"}),e.jsx("img",{src:n.pictureIds[0]?H.VITE_SERVER_URL+"/items/pictures/"+n.pictureIds[0]:V,alt:"wanted item photo",className:g("w-full h-full object-cover",{hidden:!c}),onLoad:()=>o(!0)})]}),e.jsxs("div",{className:"text-[12px]",children:[e.jsx("h4",{className:"line-clamp-1 break-all text-[16px] mb-2",children:a(n.name)}),r?e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[a("Category"),": "]}),n.category]}):e.jsxs("p",{children:[e.jsxs("span",{className:"text-green600",children:[a("Wants to exchange on"),":"]}),e.jsx("br",{}),e.jsx("span",{className:"line-clamp-1",children:n.wantedCategory})]})]})]})},v=({offered:n,requested:r,myDeal:c,incoming:o=!1,status:a,id:l,refetch:x})=>{const{t:s}=b(),{data:t,isLoading:m}=F(c?r.userId:n.userId),[d]=M(),[C]=U(),[I]=_(),[E]=A();console.log(a);const w=({className:p})=>{if(t)return e.jsxs(O,{to:N.PROFILE.replace(":id",t.id),className:g("text-green600",p),children:[t.name," ",t.surname]})},D=async()=>{if((await d(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal deleted"),{className:"!bg-green100"}),x()},L=async()=>{if((await C(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal accepted"),{className:"!bg-green100"}),x()},R=async()=>{if((await I(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal canceled"),{className:"!bg-green100"}),x()},k=async()=>{if((await E(l)).error){i.error(s("Something went wrong, try again later."),{className:"!bg-error"});return}i.success(s("Deal finished"),{className:"!bg-green100"}),x()};return e.jsx(j,{className:"!font-semibold w-full",children:m?e.jsx(f,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:g("flex gap-4 w-full",t?"justify-between":"justify-end"),children:[t&&e.jsxs("h2",{className:"text-[24px] below-768:text-[24px] mb-[24px] below-768:mb-[4px] leading-none",children:[s("Deal")," ",s("with")," ",e.jsx(w,{})]}),e.jsxs("div",{children:[s("Status"),": ",a===0?e.jsx("span",{className:"text-orange400",children:s("Requested")}):a===1?e.jsx("span",{className:"text-green600",children:s("Started")}):a===2?e.jsx("span",{className:"text-soft-red",children:s("Canceled")}):a===4?e.jsx("span",{className:"text-teal400",children:s("Finished")}):"..."]})]}),e.jsxs("div",{className:"w-full shrink-[1.1]",children:[e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Item of user")," ",e.jsx(w,{}),":"]}),e.jsx(y,{item:c?r:n}),e.jsxs("div",{className:"relative mb-[24px] mt-[32px] below-768:mb-[16px]  below-768:mt-[20px]",children:[e.jsx(z,{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white100 px-2 box-content"}),e.jsx("hr",{className:"h-px border-none w-full bg-green400"})]}),e.jsxs("h3",{className:"mb-[16px] below-768:mb-[12px] text-[16px]",children:[s("Your item"),":"]}),e.jsx(y,{myItem:!0,item:c?n:r})]}),e.jsxs("div",{className:"flex items-center justify-end gap-[16px] mt-[16px]",children:[o&&a===0&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:D,children:s("Decline")}),e.jsx(h,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:L,children:s("Accept")})]}),a===1&&e.jsxs(e.Fragment,{children:[e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:R,children:s("Cancel")}),e.jsx(h,{size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:k,children:s("Finish")})]}),(a===0&&!o||a===2||a===4)&&e.jsx(h,{variant:"secondary",size:"sm",className:"!text-[16px] !px-[24px] !h-[40px]",onClick:D,children:s("Delete")})]})]})})},Q=()=>{const{t:n}=b(),r=u.useContext(G),{data:c,isLoading:o,refetch:a}=B(),[l,x]=u.useState([]);return u.useEffect(()=>{c&&x(c.list.filter(({requestedItem:s,offeredItem:t})=>s.userId===r.id||t.userId===r.id))},[c,x]),e.jsxs(T,{children:[e.jsx(P,{to:N.HOME,children:n("return to Home page")}),e.jsxs(j,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:n("Outcoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId!==r.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId!==r.id).map(({status:s,offeredItem:t,requestedItem:m,id:d})=>e.jsx(v,{id:d,myDeal:t.userId===r.id,offered:t,requested:m,status:s,refetch:a},d))}):e.jsx("span",{className:"text-xl font-semibold",children:n("You don't have any outcoming deals yet")})]}),e.jsxs(j,{className:"mt-8",children:[e.jsx("h2",{className:"text-3xl font-semibold mb-6",children:n("Incoming deals")}),o?e.jsx(f,{className:"mx-auto mt-4"}):l.filter(({requestedItem:s})=>s.userId===r.id).length>0?e.jsx("div",{className:"[&>*]:w-1/2 below-768:[&>*]:w-full gap-4 flex flex-wrap",children:l.filter(({requestedItem:s})=>s.userId===r.id).map(({status:s,offeredItem:t,requestedItem:m,id:d})=>e.jsx(v,{id:d,incoming:!0,myDeal:t.userId===r.id,offered:t,requested:m,status:s,refetch:a},d))}):e.jsx("span",{className:"text-xl font-semibold",children:n("You don't have any incoming deals yet")})]})]})},ee=Y(Q);export{ee as default};
